# 3회차

## 네트워크

### LAN

- 집, 사무실, 건물가 같이 가까운 지역을 네트워크 매체를 이용하여 하나로 묶는 근거리 통신망
- 이더넷을 주로 사용
- 무선은 무선랜
- 구성 방식에 따라서 스타, 버스, 링 망으로 나뉘고 각자 트레이드 오프가 있음

### LAN 전송방식

- 이더넷과 CSMA/CD
    - 48비트의 고유한 MAC 주소 기반
    - 기기들을 상호 연결하기 위해 허브, 스위치, 리피터 장치 사용
    - 이더넷은 반송파 감지 다중 접속 및 충동 감지 방식 이용
    - 토큰링: 링 + 토큰
    - FDDI: 광섬유 케이플 기반 링 구조 통신망
        - 토큰 방법도 사용
- MAN
- WAN
    - 전용회선 vs 교환 회선
        - 교환 회선은 또 회선 교환(전화) vs 패킷 교환(컴퓨터네트워크)
        - 패킷이란 전달하고자 하는 정보를 일정 크기로 분할 + 송수신 주소 + 관련 정보를 추가한 것
            - 패킷 교환은  또 방식이 데이터그램(비연결, 순서 무시, 비연결 서비스), 가상회선(연결서비스, 순서보장, 단일 파이프, 단위는 패킷)으로 나뉘어짐
- 인터네트워킹 장비
    - 네트워크와 네트워크를 연결
    - 게이트웨이라고 한다. 서로다른 프로토콜과 통신망을 이어줌
    - 리피터(물리), 브리지(데이터링크), 라우터(밑에서 세개), 게이트웨이(전계층)

## TCP/IP

- 네트워크 인터페이스(이더넷, 토큰링), 인터넷(IP, ICMP, ARP), 전송(TCP, UDP), 응용 계층(HTTP, SMTP, POP3, DNS, NFS FTP, SSH … )
- 네트워크 인터페이스 계층
    - 이더넷 등으로 연결된 물리적인 네트워크
    - 보내는 쪽: 패킷을 받아 프레임으로 만들어서 회선에 올림
    - 받는 쪽: 필요한 데이터를 추출하여 조합한 프레임을 패킷으로 변환
- 인터넷 계층
    - 패킷을 목적지까지 전달
    - 제대로 도착했는지, 손상되었는지는 전송 계층에서 확인
    - ARP: ARP(주소 결정 프로토콜)는 네트워크 상에서 IP 주소를 물리적 네트워크 주소(MAC 주소)로 대응시키기 위해 사용되는 프로토콜이다. 즉, ARP는 IP 주소와 MAC 주소를 일대일 매칭 시켜 LAN에서 목적지를 찾아갈 수 있도록 하는 프로토콜이다. IP주소와 MAC 주소를 일대일 대응하여 정리한 테이블을 **ARP Table**이라고 한다.
- 전송 계층
    - 응용으로부터 받은 데이터를 세그먼트로 만들어서 목표로 보냄
    - TCP, UDP
- 응용 계층

## OSI 7계층

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19f14110-c29c-496f-9b95-062969c86b08/9db2b2a4-29a6-4ee1-bfef-5a64c9605ce9/Untitled.png)

- 물리 계층
    - 데이터를 비트로 전송
    - 허브, 리피터
- 데이터링크 계층
    - 네트워크 계층에서 받은 데이터를 MAC주소와 전송제어, 오류제어, 흐름 제어 같은 정보를 추가시켜서 프레임으로 만들어 밑으로 보냄
    - 오류 제어에서는 **송신자**가 데이터를 재전송
- 네트워크 계층
    - 패킷으로 분할하여 전송
    - 데이터링크가 인접한 두 시스템 간의 전송을 담당했다면 네트워크 계층은 패킷을 최종 수신 측까지 정확하게 전송할 수 있는 경로를 담당
    - 올바른 경로를 택할 수 있도록 지원
    - 패킷 경로를 결정하는 라우팅 및 혼잡제어, 패킷의 분할 병합, 인터네트워킹
- 전송 계층
    - 데이터 전송 서비스
    - 송신, 수신 측 사이의 실제적인 연결 설정 및 유지, 신뢰성 있는 통신 책임
    - 네트워크 계층은 패킷을 책임지나 전송 계층에서는 전체 메시지를 책임
- 세션 계층
    - 응용 간의 통신을 관리하는 방법, 동기화 유지 서비스, 전송 순서 제공
    - 데이터 전송 중에 오류 발생시 재전송
- 표현 계층
    - 코드 및 문자를 번역
    - 인코딩, 디코딩
    - 압축, 압축 해제
- 응용 계층
    - 응용 프로그램, 사용자에게 편리한 환경 제공

### 프로토콜 데이터 단위

- PDU = PCI(헤더) + SDU(실제 정보)
- 응용/표현/세션 = data
- 전송 = segment
- 네트워크 = packet
- 데이터링크 = 프레임
- 물리 계층 = 비트

### 포트번호

- 네트워크 → 전송으로 갈 때, 서비스 다중화를 위해서 포트로 관리
- /etc/services에서 주요 포트번호 확인가능

## 네트워크 환경

- modeprobe → 커널에 로드
- lsmod로 커널 확인

### 넷마스크와 게이트웨이 주소

- 네트워크 주소 설정을 위해서는 IP주소, 넷마스크주소, 게이트웨이 주소 + 호스트네임, 도메인 이름

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19f14110-c29c-496f-9b95-062969c86b08/1c6e8c0f-c873-4ef6-b8c8-fe344c7090d6/Untitled.png)

- 넷마스크 주소는 서브넷 마스크라고도 불린다. 네트워크를 분할하여 새로운 하위 네트워크 구성할 때 사용
- 네트워크 주소: 0할당, 호스트의 접근 허가 거부 때 사용
- 브로드캐스트주소: 255 할당,네트워크 내의 모든 호스트들에게 메시지를 전달할 때
- 게이트웨이 주소: 1, 254, 네트워크 간의 통신을 가능하게 해줌
- 서브넷 마스크
    
    네트워크의 IP 주소는 네트워크 ID와 호스트 ID로 구분되며, 이 두 부분을 구분하는 것이 바로 서브넷 마스크입니다.
    
    1. 서브넷 마스크에서 1과 0은 어떤 역할을 하는가?
    서브넷 마스크는 이진수 형태로 표현될 때 '1'과 '0'으로 이루어져 있습니다. '1'은 네트워크 주소를, '0'은 호스트 주소를 나타냅니다. 예를 들어, 서브넷 마스크가 255.255.255.0인 경우에는 이진수로 11111111.11111111.11111111.00000000이 됩니다. 여기서 '1'이 24개인데, 이는 네트워크 주소가 24비트, 즉 처음 세 개의 숫자 세트(옥텟)를 차지함을 의미하고, 나머지 '0'이 차지하는 부분이 호스트 주소가 됩니다.
    2. 네트워크 접두어에 대한 이해:
    네트워크 접두어는 서브넷 마스크에서 '1'의 개수를 나타내며, CIDR(Classless Inter-Domain Routing) 표기법에서 사용됩니다. 예를 들어, IP 주소가 '192.168.1.0/24'인 경우, '24'는 네트워크 접두어를 나타내며 이는 네트워크 주소 부분이 24비트라는 것을 의미합니다. 이 경우, 서브넷 마스크는 255.255.255.0이 됩니다.
    
    이렇게 서브넷 마스크와 네트워크 접두어를 통해 IP 주소의 네트워크 부분과 호스트 부분을 구분하게 되며, 이를 통해 특정 IP 주소가 어떤 네트워크에 속하고, 그 네트워크 내에서 어떤 호스트를 가리키는지를 파악할 수 있습니다.
    
- 예시)
    - IP주소가 192.168.3.12이고 넷마스크 주솟값이 255.255.255.0 이면 192.168.3.12/24로 표기
    - 이 뜻은 192.168.3.0 ~ 192.168.3.255 까지 256개 호스트를 하나의 네트워크로 묶는다.
    - 하지만 여기서 네트워크 주소, 브로드캐스트 주소, 인터넷에 연결한다면 게이트웨이 주소가 빠져서 253개만 사용이 가능하다.

### 네트워크 관련 명령어

- ip
    - addr, route, link + show, list, add, del
- ipconfig, route도 다 ip로 대체

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19f14110-c29c-496f-9b95-062969c86b08/23f2aff4-42fc-4b2d-b2e0-2f934a3d6b8e/Untitled.png)

- default란? 목적지 네트워크로 등록되지 않은 다른 모든 네트워크 주소를 처리하는 곳
- gateway: 목적지 주소로 보내기 위한 게이트웨이 주소
- 지피티 해석
    
    이 내용은 리눅스 시스템에서 `route` 명령어를 이용해 조회한 라우팅 테이블의 일부입니다. 각 열은 아래와 같은 내용을 나타냅니다:
    
    - `Destination`: 패킷이 도착해야 하는 최종 목적지 또는 네트워크를 나타냅니다. `default`는 특정 목적지에 해당하지 않는 모든 주소를 가리킵니다.
    - `Gateway`: 패킷을 해당 목적지로 전송하는 데 사용되는 게이트웨이(라우터)의 IP 주소입니다. `ip-172-31-32-1.`라는 주소가 게이트웨이 주소입니다.
    - `Genmask`: 목적지의 넷마스크를 나타냅니다. `0.0.0.0`은 모든 IP 주소를 가리킵니다.
    - `Flags`: 라우트의 속성을 나타내는 플래그입니다. `UG`의 경우, `U`는 해당 라우트가 사용 가능함을 나타내고, `G`는 해당 라우트가 게이트웨이를 통해 이루어짐을 나타냅니다.
    - `Metric`: 라우트의 비용을 나타내는 메트릭 값입니다. 여기서는 `0`으로 설정되어 있습니다.
    - `Ref`: 해당 라우트를 참조하는 횟수입니다. 여기서는 `0`입니다.
    - `Use`: 해당 라우트를 사용한 패킷의 수입니다. 여기서는 `0`입니다.
    - `Iface`: 해당 라우트를 처리하는 네트워크 인터페이스를 나타냅니다. 여기서는 `eth0`이라는 이더넷 인터페이스를 사용합니다.
    
    따라서 이 라우팅 테이블은 모든 목적지(`default`)로 가는 패킷을 `ip-172-31-32-1.` 게이트웨이를 통해 `eth0` 인터페이스를 사용하여 전송하라는 정보를 나타냅니다. 이는 기본적으로 외부 네트워크로 나가는 모든 패킷을 위한 기본 라우트(default route)입니다.
    
- netstat, ss, arp, mii-tool, ethtool, ping, traceroute, nslookup, dig, host, hostname, whois, wget(다운로드)

### 네트워크 관련 파일 및 디렉터리

- /etc/sysconfig/network-scripts
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/19f14110-c29c-496f-9b95-062969c86b08/cd104662-61de-416f-a10a-1d7fd8a69267/Untitled.png)
    
    - 네트워크 인터페이스는 ifg-~ 로 구성
- /etc/resolv.conf - 네임서버
- /etc/hosts - ip주소와 호스트명 매핑
